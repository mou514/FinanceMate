name = "focal-expensi"
main = "worker/index.ts"
compatibility_date = "2025-10-04"
compatibility_flags = ["nodejs_compat"]

# Serve frontend assets (production only)
# For local development, Vite serves the frontend on port 3000
[assets]
directory = "./dist"
binding = "ASSETS"

# D1 Database binding
[[d1_databases]]
binding = "DB"
database_name = "focal_expensi_db"
database_id = "2c3d6a69-e2ca-4a94-98a0-0def7b7bf404"

# Environment variables (use wrangler secrets for production)
[vars]
NODE_ENV = "production"
AI_PROVIDER = "gemini"  # Options: 'gemini' | 'openai' | 'nvidia' | 'groq'
SUPER_ADMIN_EMAIL = "admin@admin.com"

# Production secrets (set using wrangler secret put):
# JWT_SECRET - Secret key for JWT token signing
# ENCRYPTION_KEY - Key for encrypting sensitive data in database
# BREVO_API_KEY - (Optional) Brevo API key for sending transactional emails
# APP_URL - (Optional) Application URL for email verification links (e.g., https://focal-expense.app)
# ADMIN_EMAIL - (Optional) Email address for admin access (e.g., admin@example.com)
#
# AI Provider Secrets (configure the one matching your AI_PROVIDER):
# GEMINI_API_KEY - Google Gemini API key (for AI_PROVIDER=gemini)
# GITHUB_TOKEN - GitHub token for GitHub Models (for AI_PROVIDER=openai)
# NVIDIA_API_KEY - Nvidia NIM API key (for AI_PROVIDER=nvidia)
# GROQ_API_KEY - Groq API key (for AI_PROVIDER=groq)
# AZURE_VISION_ENDPOINT - Azure Computer Vision endpoint (required for AI_PROVIDER=groq)
# AZURE_VISION_KEY - Azure Computer Vision API key (required for AI_PROVIDER=groq)
# AI_MODEL - (Optional) Override default model (e.g., 'gemini-2.5-pro', 'gpt-4o', 'llama-3.3-70b-versatile')

[observability]
[observability.logs]
enabled = true
head_sampling_rate = 1
invocation_logs = true
persist = true